<!-- 
Project Name: SPIKE Reaction Game
Author: Ethan Danahy
Last update: October 25th, 2021
Description: Use a Chrome Browser and SPIKE Prime to
			 play a reaction matching game
(C) Tufts Center for Engineering Education and Outreach (CEEO)
-->
<html>
    <head>
	    <title>SPIKE Reaction Game</title>
        <!--TuftsCEEO ServiceDock-->
        <script src="https://cdn.jsdelivr.net/gh/tuftsceeo/SPIKE-Web-Interface@1.0/cdn/ServiceDock.min.js"></script>
        <!-- local JS code to run the game -->
        <script src="./script.js"></script>
        <style>
	        .bottom_text {
		        color: #000;
	        }
	        .mainimage {
		        width: 185px;
		        height: 242px;
		    }
		</style>
		<script>
		</script>
    </head>
    <body>

	<!-- ServiceDock -->
	<div style="position: absolute; z-index: 1000; top: 5px; left: 5px;" align=center>
		<button onclick="hideControls();">Controls:</button><br />
		<span id="controls">
			<button onclick="setupInfo();">Setup Info</button><br />
			Player 1:<br />
		    <service-spike id="service_SPIKE1"></service-spike><br />
			Player 2:<br />
		    <service-spike id="service_SPIKE2"></service-spike><br />
			Reward:<br />
		    <service-spike id="service_SPIKE3"></service-spike><br />
		</span><br />
		<button onclick="play();">Play!</button>
	</div>

	<br />

	<!-- GAME TABLE -->
	<table align=center border=0 cellpadding=5 cellspacing=5>
		<tr>
			<td colspan=2 align=center><b>Instructions:</b> press your sensor when the two images match</td>
		</tr><tr>
			<th>Reference Image:</th>
			<th>Match Image:</th>
		</tr><tr>
			<td><img id="image_ref" class="mainimage" src="Fruit0.png"></td>
			<td><img id="image_match" class="mainimage" src="Fruit0.png"></td>
		</tr><tr>
			<td id="resultrow" colspan=2 style="font-size: 24px;"><b>Result:</b> <span id="result"></span></td>
		</tr>
	</table>

	<br /><br />
	
	<hr />

	<p class="bottom_text"><b>Disclaimer</b></p>

	<p class="bottom_text">LEGO®, the LEGO® logo, the Brick, MINDSTORMS®, SPIKE™, and the Minifigure are trademarks of ©The LEGO® Group. All other trademarks and copyrights are the property of their respective owners. All rights reserved.</p>

	<p class="bottom_text">This page isn’t affiliated, authorized, or endorsed by The LEGO Group.</p>

    </body>
    
    <!-- SCRIPTS THAT MAKE THIS RUN -->
    <script>

/*


	    function start_monitoring() {
		    var mode_selector = document.getElementById("spike_input");
			var mode = mode_selector.options[mode_selector.selectedIndex].value;
		    if (mode == 'accelerometer') {
			    sensor = new mySPIKE.PrimeHub().motion_sensor;
			    sensor_func = sensor.get_roll_angle;
			    min_val = -180;
			    max_val = 180;
			    poll_sensor();
		    } else if (mode == 'motor') {
			    sensor = new mySPIKE.Motor("A");
			    sensor_func = sensor.get_degrees_counted;
			    min_val = -360;
			    max_val = 360;
				poll_sensor();
		    } else if (mode == 'distance') {
			    sensor = new mySPIKE.DistanceSensor("B");
			    sensor_func = sensor.get_distance_percentage;
			    min_val = 0
			    max_val = 1
			    poll_sensor();
		    } else {
			    alert('MODE NOT RECOGNIZED.')
		    }
		    
	    }
	    
	    // check sensor value and move eyes accordingly
	    function poll_sensor() {
		    var sensor_value = sensor_func();
		    document.getElementById("value").innerHTML = sensor_value;
		    if (sensor_value != 'none') {
			    sensor_value = Math.min(Math.max(parseFloat(sensor_value), min_val), max_val);
				move_eyes((sensor_value - min_val)/(max_val - min_val));
			}
			setTimeout(poll_sensor, 300); // recheck sensor
	    }
	    
	    // move eyes across screen by a certain percent
	    // - new_percent is between 0 and 1
	    function move_eyes (new_percent) {
		    var vampire_eyes = document.getElementById("vampire_eyes");
		    var min_translate_position = 0;
		    var max_translate_position = 200; // total size of translate shift
		    var translate_amount = new_percent * (max_translate_position - min_translate_position) + min_translate_position;
		    // update the location of eyes
			vampire_eyes.style.transform = "translate(" + Number.parseInt(translate_amount) + "px, 0px)";
	    }
*/
    </script>
</html>